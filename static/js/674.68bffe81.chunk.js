"use strict";(self.webpackChunkpartner_hero_test=self.webpackChunkpartner_hero_test||[]).push([[674],{6052:function(e,n,t){t.d(n,{C:function(){return i},T:function(){return r}});var o=t(9434),r=function(){return(0,o.I0)()},i=o.v9},4674:function(e,n,t){t.r(n),t.d(n,{default:function(){return b}});var o=t(885),r=t(2791),i=t(8735),c=t(855),a=t(3046),s=t(2504),u=t(9135),l=t(3504),d=t(6871),f=encodeURI("https://accounts.spotify.com/authorize?".concat("client_id=58b3f355fdca46428a44c4596f4b9fe0&response_type=code&redirect_uri=https://partnerherospotify.web.app/auth&scope=user-read-private user-read-email user-read-email user-read-email user-library-read ugc-image-upload user-library-modify")),h=function(){return window.location.replace(f)},p=(t(2180),t(408),t(9778)),g=p.lW.from("".concat(String("58b3f355fdca46428a44c4596f4b9fe0")+":"+String("395fff7617454220be2e2be859b7ed33"))).toString("base64"),v=new Headers;v.append("Content-Type","application/x-www-form-urlencoded"),v.append("authorization","Basic ".concat(g));var k=function(){var e=(0,r.useState)(),n=(0,o.Z)(e,2),t=n[0],i=n[1],c=(0,r.useState)(),a=(0,o.Z)(c,2),s=a[0],u=a[1],l=(0,r.useState)(),d=(0,o.Z)(l,2),f=d[0],h=d[1],p=(0,r.useState)(),g=(0,o.Z)(p,2),k=g[0],m=g[1],x=(0,r.useState)(),S=(0,o.Z)(x,2),_=S[0],b=S[1];return{getAccessToken:function(e){i(!0);var n=new URLSearchParams;n.append("code","".concat(e)),n.append("redirect_uri","".concat("http://localhost:3000/auth")),n.append("grant_type","authorization_code"),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:v,body:n}).then((function(e){return e.json()})).then((function(e){null!==e&&void 0!==e&&e.error?(u(!0),h(e),b(null),m(!1)):(u(!1),h(null),m(!0),b(e),localStorage.setItem("tokens",JSON.stringify(e))),i(!1)})).catch((function(e){u(!0),h(e),m(!1),b(null),i(!1)})),i(!1)},getRefreshToken:function(e){i(!0);var n=new URLSearchParams;n.append("grant_type","refresh_token"),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:v,body:n}).then((function(e){return e.json()})).then((function(e){null!==e&&void 0!==e&&e.error?(u(!0),h(e),b(null)):(u(!1),h(null),m(!0),b(e),localStorage.setItem("tokens",JSON.stringify(e))),i(!1)})).catch((function(e){u(!0),h(e),b(null),m(!1),i(!1)})),i(!1)},isLoading:t,isError:s,error:f,isSuccess:k,data:_}},m=t(6052),x=t(131),S=t(929),_=t(184),b=function(){var e=(0,l.lr)(),n=(0,o.Z)(e,1)[0],t=k(),f=t.data,p=t.error,g=t.getAccessToken,v=t.getRefreshToken,b=(t.isError,t.isLoading),y=(t.isSuccess,n.get("code")),w=(0,m.T)(),j=(0,d.s0)(),C=localStorage.getItem("tokens"),I=JSON.parse(C),T=(null===I||void 0===I||I.access_token,null===I||void 0===I?void 0:I.refresh_token),E=(0,m.C)((function(e){return e.authToken})),z=(E.access_token,E.refresh_token);return(0,r.useEffect)((function(){y&&g(y)}),[y]),(0,r.useEffect)((function(){if(z&&null!==f&&void 0!==f&&f.expires_in){var e=setInterval((function(){v(z||T)}),1e3*((null===f||void 0===f?void 0:f.expires_in)-60));return clearInterval(e)}}),[z,null===f||void 0===f?void 0:f.expires_in]),(0,r.useEffect)((function(){null!==f&&void 0!==f&&f.refresh_token&&null!==f&&void 0!==f&&f.access_token&&f&&null!==f&&void 0!==f&&f.access_token&&(w((0,x.o)({access_token:String(null===f||void 0===f?void 0:f.access_token),refresh_token:String(null===f||void 0===f?void 0:f.refresh_token)})),j("/"))}),[p,f]),(0,_.jsx)(_.Fragment,{children:b?(0,_.jsx)(S.$7,{}):(0,_.jsxs)(i.Kq,{minH:"100vh",direction:{base:"column",md:"row",lg:"row"},children:[(0,_.jsx)(i.kC,{as:c.c,flex:[2,1,2],below:"sm",children:(0,_.jsx)(a.Ee,{alt:"Login Image",objectFit:"cover",src:"https://images.unsplash.com/photo-1490476323407-63a2b2baa393?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=892&q=80"})}),(0,_.jsx)(i.kC,{p:8,flex:1,align:"center",justify:"center",children:(0,_.jsxs)(i.Kq,{spacing:4,w:"full",maxW:"md",children:[(0,_.jsxs)(i.Kq,{children:[(0,_.jsx)(i.X6,{fontSize:"2xl",children:"Sign In to your Spotify Account"}),(0,_.jsx)(i.xv,{color:"gray.500",fontSize:{base:"sm",sm:"md"},children:"Enjoy non-stop Music Stream"})]}),(0,_.jsx)(i.Kq,{spacing:6,children:(0,_.jsx)(s.zx,{leftIcon:(0,_.jsx)(u.l4C,{}),bg:"dark",variant:"solid",color:"ghostWhite",_hover:{color:"dark",backgroundColor:"ghostWhite"},onClick:h,children:"Sign in with Spotify"})})]})})]})})}}}]);
//# sourceMappingURL=674.68bffe81.chunk.js.map