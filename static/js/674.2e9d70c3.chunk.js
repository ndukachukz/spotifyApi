"use strict";(self.webpackChunkpartner_hero_test=self.webpackChunkpartner_hero_test||[]).push([[674],{6052:function(e,n,t){t.d(n,{C:function(){return i},T:function(){return r}});var o=t(9434),r=function(){return(0,o.I0)()},i=o.v9},4674:function(e,n,t){t.r(n),t.d(n,{default:function(){return w}});var o=t(885),r=t(2791),i=t(8735),c=t(855),a=t(3046),s=t(2504),l=t(9135),u=t(3504),d=t(6871),f=window.location.href,h=encodeURI("https://accounts.spotify.com/authorize?".concat("client_id=58b3f355fdca46428a44c4596f4b9fe0&response_type=code&redirect_uri="+f+"&scope=user-read-private user-read-email user-read-email user-read-email user-library-read ugc-image-upload user-library-modify")),p=function(){return window.location.replace(h)},g=(t(2180),t(408),t(9778)),v=g.lW.from("".concat(String("58b3f355fdca46428a44c4596f4b9fe0")+":"+String("395fff7617454220be2e2be859b7ed33"))).toString("base64"),k=new Headers;k.append("Content-Type","application/x-www-form-urlencoded"),k.append("authorization","Basic ".concat(v));var m=function(){var e=(0,r.useState)(),n=(0,o.Z)(e,2),t=n[0],i=n[1],c=(0,r.useState)(),a=(0,o.Z)(c,2),s=a[0],l=a[1],u=(0,r.useState)(),d=(0,o.Z)(u,2),f=d[0],h=d[1],p=(0,r.useState)(),g=(0,o.Z)(p,2),v=g[0],m=g[1],x=(0,r.useState)(),S=(0,o.Z)(x,2),_=S[0],b=S[1];return{getAccessToken:function(e){i(!0);var n=new URLSearchParams;n.append("code","".concat(e)),n.append("redirect_uri","".concat("http://localhost:3000/auth")),n.append("grant_type","authorization_code"),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:k,body:n}).then((function(e){return e.json()})).then((function(e){null!==e&&void 0!==e&&e.error?(l(!0),h(e),b(null),m(!1)):(l(!1),h(null),m(!0),b(e),localStorage.setItem("tokens",JSON.stringify(e))),i(!1)})).catch((function(e){l(!0),h(e),m(!1),b(null),i(!1)})),i(!1)},getRefreshToken:function(e){i(!0);var n=new URLSearchParams;n.append("grant_type","refresh_token"),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:k,body:n}).then((function(e){return e.json()})).then((function(e){null!==e&&void 0!==e&&e.error?(l(!0),h(e),b(null)):(l(!1),h(null),m(!0),b(e),localStorage.setItem("tokens",JSON.stringify(e))),i(!1)})).catch((function(e){l(!0),h(e),b(null),m(!1),i(!1)})),i(!1)},isLoading:t,isError:s,error:f,isSuccess:v,data:_}},x=t(6052),S=t(131),_=t(929),b=t(184),w=function(){var e=(0,u.lr)(),n=(0,o.Z)(e,1)[0],t=m(),f=t.data,h=t.error,g=t.getAccessToken,v=t.getRefreshToken,k=(t.isError,t.isLoading),w=(t.isSuccess,n.get("code")),y=(0,x.T)(),j=(0,d.s0)(),C=localStorage.getItem("tokens"),I=JSON.parse(C),T=(null===I||void 0===I||I.access_token,null===I||void 0===I?void 0:I.refresh_token),E=(0,x.C)((function(e){return e.authToken})),z=(E.access_token,E.refresh_token);return(0,r.useEffect)((function(){w&&g(w)}),[w]),(0,r.useEffect)((function(){if(z&&null!==f&&void 0!==f&&f.expires_in){var e=setInterval((function(){v(z||T)}),1e3*((null===f||void 0===f?void 0:f.expires_in)-60));return clearInterval(e)}}),[z,null===f||void 0===f?void 0:f.expires_in]),(0,r.useEffect)((function(){null!==f&&void 0!==f&&f.refresh_token&&null!==f&&void 0!==f&&f.access_token&&f&&null!==f&&void 0!==f&&f.access_token&&(y((0,S.o)({access_token:String(null===f||void 0===f?void 0:f.access_token),refresh_token:String(null===f||void 0===f?void 0:f.refresh_token)})),j("/"))}),[h,f]),(0,b.jsx)(b.Fragment,{children:k?(0,b.jsx)(_.$7,{}):(0,b.jsxs)(i.Kq,{minH:"100vh",direction:{base:"column",md:"row",lg:"row"},children:[(0,b.jsx)(i.kC,{as:c.c,flex:[2,1,2],below:"sm",children:(0,b.jsx)(a.Ee,{alt:"Login Image",objectFit:"cover",src:"https://images.unsplash.com/photo-1490476323407-63a2b2baa393?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=892&q=80"})}),(0,b.jsx)(i.kC,{p:8,flex:1,align:"center",justify:"center",children:(0,b.jsxs)(i.Kq,{spacing:4,w:"full",maxW:"md",children:[(0,b.jsxs)(i.Kq,{children:[(0,b.jsx)(i.X6,{fontSize:"2xl",children:"Sign In to your Spotify Account"}),(0,b.jsx)(i.xv,{color:"gray.500",fontSize:{base:"sm",sm:"md"},children:"Enjoy non-stop Music Stream"})]}),(0,b.jsx)(i.Kq,{spacing:6,children:(0,b.jsx)(s.zx,{leftIcon:(0,b.jsx)(l.l4C,{}),bg:"dark",variant:"solid",color:"ghostWhite",_hover:{color:"dark",backgroundColor:"ghostWhite"},onClick:p,children:"Sign in with Spotify"})})]})})]})})}}}]);
//# sourceMappingURL=674.2e9d70c3.chunk.js.map